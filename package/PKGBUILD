_pkgname=mimejs
pkgname=$_pkgname-git
pkgver=0.1.2a3d118
pkgrel=1
pkgdesc="A Node.js replacement for xdg-open"
arch=('i686' 'x86_64')
url="https://github.com/karabaja4/mimejs"
license=('MIT')
depends=('file' 'bash')
makedepends=('nodejs-lts-fermium' 'npm')
provides=('xdg-utils')
conflicts=('xdg-utils')
source=('git+https://github.com/karabaja4/mimejs.git')
md5sums=('SKIP')

pkgver() {
  cd "$_pkgname"
  echo "0.1.$(git rev-parse --short HEAD)"
}

build() {
  cd $_pkgname
  npm install
  pkg --targets linux main.js
}

package() {
  cd $_pkgname
  install -Dm644 "$srcdir/mime.json" "${pkgdir}/etc/mime.json"
  make INSTALL_ROOT="$pkgdir" install
}